## ElasticSearch基本概念

### Near Real Time（ NRT，接近实时）

        Elasticsearch是一个接近实时的搜索平台。这意味着，从索引一个文档直到这个文档能够被搜索到有一个轻微的延迟（通常是1秒）。 



### Index （索引）



名词：一个 索引 类似于传统关系数据库中的一个 数据库 ，是一个存储关系型文档的地方。 



动词：索引一个文档 就是存储一个文档到一个 索引 （名词）中以便它可以被检索和查询到。这非常类似于 SQL 语句中的 INSERT 关键词，除了文档已存在时新文档会替换旧文档情况之外。



### Document（文档）

一个文档是一个可被索引的基础信息单元。在大多数应用中，多数实体或对象可以被序列化为包含键值对的 JSON 对象。 



###  Type（类型）从6.0.0 版本起，一个索引中只存放一类数据，7.0.0版本起将废弃



 在一个索引中，你可以定义一种或多种类型。一个类型是你的索引的一个逻辑上的分类/分区，其语义完全由你来定。通常，会为具有一组共同字段的文档定义一个类型。比如说，我们假设你运营一个博客平台并且将你所有的数据存储到一个索引中。在这个索引中，你可以为用户数据定义一个类型，为博客数据定义另一个类型，当然，也可以为评论数据定义另一个类型。 



###  cluster

代表一个集群，集群中有多个节点，其中有一个为主节点，这个主节点是可以通过选举产生的，主从节点是对于集群内部来说的。es的一个概念就是去中心化，字面上理解就是无中心节点，这是对于集群外部来说的，因为从外部来看es集群，在逻辑上是个整体，你与任何一个节点的通信和与整个es集群通信是等价的。



### node

 一个节点是你集群中的一个服务器，作为集群的一部分，它存储你的数据，参与集群的索引和搜索功能。和集群类似，一个节点也是由一个名字来标识的，默认情况下，这个名字是一个随机的漫威漫画角色的名字，这个名字会在启动的时候赋予节点。这个名字对于管理工作来说挺重要的，因为在这个管理过程中，你会去确定网络中的哪些服务器对应于Elasticsearch集群中的哪些节点。 



### shards

代表索引分片，es可以把一个完整的索引分成多个分片，这样的好处是可以把一个大的索引拆分成多个，分布到不同的节点上。构成分布式搜索。分片的数量只能在索引创建前指定，并且索引创建后不能更改。



一个 分片 是一个底层的 工作单元 ，它仅保存了 全部数据中的一部分，一个分片是一个 Lucene 的实例，以及它本身就是一个完整的搜索引擎



分片之所以重要，主要有以下两方面的原因：

\(1 ） 允许你水平分割／扩展你的内容容量。

\( 2 ） 允许你在分片（潜在地，位于多个节点上〉上进行分布式的、并行的操作，进而提

高性能和吞吐量 ， 至于一个分片怎样分布，它的文档怎样聚合回搜索请求，完全由 Elasticsearch

管理 ， 对于用户来说，这些都是透明的 。



### replicas

代表索引副本，es可以设置多个索引的副本，副本的作用一是提高系统的容错性，当某个节点某个分片损坏或丢失时可以从副本中恢复。二是提高es的查询效率，es会自动对搜索请求进行负载均衡。



副本之所以重要，有以下两个主要原因：

\(1 ） 在分片／节点失败的情况下，保证高可用性。因为这个原因，复制分片不与主分片置于同 一节点上，这一点非常重要 。

\( 2 ） 扩展你的搜索量／吞吐量 ，因为搜索可以在所有的副本上并行运行。 



总之，每个索引可以被分成多个分片 。一个索引可以有一至多个副本。 一旦有了副本，每个索引就有了 主分片（作为复制源的原来的分片）和副本分片（主分片的拷贝）之别。分片和副本的数量可以在索引创建的时候指定 。 在索引创建之后，可以在任何时候动态地改变副本的数量，但是事后不能改变分片的数量。



###  recovery

代表数据恢复或叫数据重新分布，es在有节点加入或退出时会根据机器的负载对索引分片进行重新分配，挂掉的节点重新启动时也会进行数据恢复。



###  gateway

代表es索引快照的存储方式，es默认是先把索引存放到内存中，当内存满了时再持久化到本地硬盘。gateway对索引快照进行存储，当这个es集群关闭再重新启动时就会从gateway中读取索引备份数据。es支持多种类型的gateway，有本地文件系统（默认）；分布式文件系统，Hadoop的HDFS等。



###  discovery.zen

代表es的自动发现节点机制，es是一个基于p2p的系统，它先通过广播寻找存在的节点，再通过多播协议来进行节点之间的通信，同时也支持点对点的交互。



###  Transport

代表es内部节点或集群与客户端的交互方式，默认内部是使用tcp协议进行交互，同时它支持http协议（json格式）、thrift、servlet、memcached、zeroMQ等的传输协议（通过插件方式集成）。

